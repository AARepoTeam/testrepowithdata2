{"triggers":[],"nodes":[{"uid":"89896c23-9659-437c-95fd-e81f94178a06","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"郵便番号を変換するボットです。37行目からアクションの使用方法がご覧いただけます。"}}]},{"uid":"c15d0c9f-8540-453f-926d-2c14c3d551ef","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"必須：下の行のボット名とベンダー名のフィールドに入力します。 これらの値は、ロギングの目的で使用されます。"}}]},{"uid":"5b864cb4-875e-4450-b0b7-6e5d89f42423","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"fa5a07fb-4dd3-4568-8aa9-4393c85b44aa","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"ボット名とベンダー名がロギングに使用するため、記入する必要があります。 さらに、これらの値はサブタスク（サブタスクが予想される場合）に渡されるか、このボットがサブタスクとして呼び出される場合は親タスクから渡される必要があります。"}}]},{"uid":"cd39079d-7970-486c-8f51-497af66d76b5","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Japanese Postcode Converter by csv"}}],"returnTo":{"type":"VARIABLE","variableName":"sBotName"}},{"uid":"7cdb7915-39f1-444d-a89c-55b75e81e282","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"Automation Anywhere"}}],"returnTo":{"type":"VARIABLE","variableName":"sVendorName"}},{"uid":"86290375-ab5c-482e-9a84-8b641e4e92be","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"cccb83ae-4134-4184-9cf7-143111ee3c0d","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Automation Anywhere Enterprise Client"}},{"name":"content","value":{"type":"STRING","string":"ボット名とベンダー名は必須の値です-前の行の値の割り当てを使用して値を入力してください。"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"6c5e48fa-5a3e-4f27-b086-a152601cc46b","commandName":"stopTask","packageName":"TaskBot","disabled":false}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sBotName$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","expression":"$sNull$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"boolean":false,"type":"BOOLEAN"}}],"name":"condition","operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"},"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sVendorName$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","expression":"$sNull$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"boolean":false,"type":"BOOLEAN"}}],"operator":"OR"},"value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"ボット名とベンダー名を確認する"}}]},{"uid":"3b04fec6-de4b-4e49-90d5-68eceff37844","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"128a8c20-6f1c-447a-ab4a-4e56e8c99972","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"ボットエージェントが使用するログの場所にデフォルトで設定されたボットロギングルートをセットします。 sRootLogDirectoryの変数ペインを参照してください。"}}]},{"uid":"73514e70-8a33-4715-8599-784a783adf73","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sRootLogDirectory$\\$sBotName$-$sVendorName$"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorFolder"}},{"uid":"bc7ae2ce-9d34-49c2-a640-52383583a39f","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sRootLogDirectory$\\$sBotName$-$sVendorName$\\Logs"}}],"returnTo":{"type":"VARIABLE","variableName":"sLogFolder"}},{"uid":"e6c3cd0f-beb6-4d0c-8e49-bb652d9f5b73","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sRootLogDirectory$\\$sBotName$-$sVendorName$\\Snapshots"}}],"returnTo":{"type":"VARIABLE","variableName":"sSnapshotsFolder"}},{"uid":"85f0cc48-82d9-4fca-a5ea-d9a1473354f6","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"このボットに固有のデフォルトのログ/エラーディレクトリの作成"}}]},{"uid":"6d44e986-d4f2-4b56-988a-e460799430c0","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"2a1ffe07-7a93-46ff-9c5a-914292e7a73f","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sRootLogDirectory$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sRootLogDirectory$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"7bb7d0bf-1c05-4d07-95ec-009ea15a4b9f","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"c2265f24-0c4a-4eda-9a17-49b6afb2ae78","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sErrorFolder$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sErrorFolder$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"411506ec-0b01-4259-bf55-ece5dd81d582","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"670a81ea-c3cb-45a1-89f8-63dd685a2975","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sLogFolder$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sLogFolder$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"a07c8322-89a5-45ba-9caa-d007ca57271b","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ce71fde6-0655-4c9f-992f-c9e8cb9cd393","commandName":"createFolder","packageName":"Folder","disabled":false,"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sSnapshotsFolder$"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]}],"branches":[],"attributes":[{"attributes":[{"name":"folderPath","value":{"type":"STRING","expression":"$sSnapshotsFolder$"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"folderDoesNotExists","packageName":"Folder"}}]},{"uid":"492c8e5b-1fec-40a1-98ec-bd47cff8c37e","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"PREBUILT"}},{"name":"preBuiltPattern","value":{"type":"STRING","string":"ISO_LOCAL_DATE"}}],"returnTo":{"type":"VARIABLE","variableName":"sCurrentDate"}}],"attributes":[{"name":"title","value":{"type":"STRING","string":"ログフォルダー/場所の設定"}}]},{"uid":"c7e19961-755f-4f99-86ff-d0ce86e03f15","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"c06d1b13-0438-470f-b446-4693e63348d0","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"ログを保持する期間を設定します。 デフォルトは30日で、必要に応じてカスタマイズできます。"}}]},{"uid":"d268f370-3182-4164-a28b-7ff908707f08","commandName":"subtract","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"val","value":{"type":"NUMBER","expression":"$nLoggingPeriod$"}},{"name":"unit","value":{"type":"STRING","string":"DAYS"}}],"returnTo":{"type":"VARIABLE","variableName":"dtLogCutoffDate"}},{"uid":"60a43ec8-f2a7-40df-a07c-8cac5b42c6bb","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","variableName":"dtLogCutoffDate"}},{"name":"selectPattern","value":{"type":"STRING","string":"CUSTOM"}},{"name":"patternInput","value":{"type":"STRING","string":"dd/MM/yy"}}],"returnTo":{"type":"VARIABLE","variableName":"sLogCutoffDate"}},{"uid":"de8792ef-cc48-4788-b530-fa80b2998499","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"ログファイルを削除できなかった場合にボットの実行が失敗しないように、tryハンドラーで削除アクションを囲んでいます。"}}]},{"uid":"95eab5af-9286-4078-a04e-dcfd077bad08","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"2b1ea342-5a3c-45e4-863e-93b4cc61c394","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"最後の変更からnLoggingPeriod日より古いログフォルダーからすべてのファイルを削除します"}}]},{"uid":"78c4f069-4d23-48ac-bdfb-9c60f053fbf0","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sLogFolder$/*.csv"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":true}},{"name":"dateValue","value":{"type":"STRING","string":"Modified"}},{"name":"dateRangeValue","value":{"type":"STRING","string":"Before"}},{"name":"beforeDate","value":{"type":"STRING","expression":"$sLogCutoffDate$"}}]}],"branches":[]},{"uid":"49f2ef6c-2cfb-4df2-91f2-7059230c453a","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"97213a13-7d25-455d-ba76-dadd1ced8874","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"最後の変更からnLoggingPeriod日より古いスナップショットフォルダからすべてのファイルを削除する"}}]},{"uid":"719fd232-7bdb-41d2-8a7f-82144bb55a45","commandName":"deleteFiles","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sSnapshotsFolder$/*.jpg"}},{"name":"isSize","value":{"type":"BOOLEAN","boolean":false}},{"name":"isDate","value":{"type":"BOOLEAN","boolean":true}},{"name":"dateValue","value":{"type":"STRING","string":"Modified"}},{"name":"dateRangeValue","value":{"type":"STRING","string":"Before"}},{"name":"beforeDate","value":{"type":"STRING","expression":"$sLogCutoffDate$"}}]}],"branches":[]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"古いログを消去する"}}]},{"uid":"2d733bef-a91a-4c63-8ef4-9ed343611949","commandName":"try","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"fd0baa02-21cf-4f57-a182-fe50894399c8","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"*********ボットロジックがここから始まります*************"}}]},{"uid":"c4c0674a-0331-41d3-8d8f-8303ed1638d0","commandName":"runTask","packageName":"TaskBot","disabled":false,"attributes":[{"name":"taskbot","value":{"type":"TASKBOT","taskbotInput":{"type":"DICTIONARY","dictionary":[]},"taskbotFile":{"type":"FILE","string":"repository:///Automation%20Anywhere/Bots/qa%20scenario%20based%20bots%20.18/Create%20work%20folder%20and%20csv"}}},{"name":"repeatOption","value":{"type":"STRING","string":"DO_NOT_REPEAT"}},{"name":"delayNextRepetition","value":{"type":"BOOLEAN","boolean":false}},{"name":"continueOnError","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"402fad83-ddf5-4a71-8d72-c0e55978f06b","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"022f79dd-a9fd-41b3-83e3-0ae312f82f7a","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"e4f8574b-9200-42fa-864b-61abb9926f22","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","string":"No input value"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sInputValue$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","expression":"$sNull$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"boolean":false,"type":"BOOLEAN"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"2ecc2d70-dcd6-4089-beaf-d003db8539cd","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"5f13ce6d-4e3d-47e7-b45c-2ceb35e1303f","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"10f04fee-cdb5-45ad-8efa-1882d6164f5e","commandName":"replace","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sInputValue$"}},{"name":"find","value":{"type":"STRING","string":"-"}},{"name":"isCaseSensitive","value":{"type":"STRING","string":"false"}},{"name":"isRegularExpression","value":{"type":"STRING","string":"false"}},{"name":"startIndex","value":{"type":"NUMBER","number":"1"}},{"name":"count","value":{"type":"NUMBER","number":"-1"}},{"name":"replaceWith","value":{"type":"STRING","expression":"$sNull$"}}],"returnTo":{"type":"VARIABLE","variableName":"sInputValue"}}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sInputValue$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","string":"-"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"boolean":false,"type":"BOOLEAN"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sSearchType$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"postcode"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"boolean":false,"type":"BOOLEAN"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"21fb37d8-f353-4b2c-8ea5-e5bdbf172d77","commandName":"length","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$sInputValue$"}}],"returnTo":{"type":"VARIABLE","variableName":"nInputValueLength"}},{"uid":"7e1d2371-8c98-43fb-8010-4f0b35ddf118","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"92a64078-2cb1-453d-a165-c229b8e92aae","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","string":"Postcode is not 5-7 digits"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$nInputValueLength$"}},{"name":"operator","value":{"type":"STRING","string":"LT"}},{"name":"value","value":{"type":"NUMBER","number":"5"}}],"name":"condition","operatorAttribute":{"value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"},"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$nInputValueLength$"}},{"name":"operator","value":{"type":"STRING","string":"GT"}},{"name":"value","value":{"type":"NUMBER","number":"7"}}],"operator":"AND"},"value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"入力値の検証および修正"}}]},{"uid":"42b14bff-c3a2-4cd1-9593-a6a50c1cafef","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"6bd0ece0-9177-4af8-8679-031e4711c36d","commandName":"OpenCSVTXT","packageName":"CsvTxt","disabled":false,"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}},{"name":"filePath","value":{"type":"FILE","expression":"file://$sWorkingDirectory$/$sCSVFileName$"}},{"name":"containsHeader","value":{"type":"BOOLEAN","boolean":false}},{"name":"delimeter","value":{"type":"STRING","string":"comma"}},{"name":"trimLeadingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"trimTrailingSpace","value":{"type":"BOOLEAN","boolean":false}},{"name":"encoding","value":{"type":"STRING","string":"UTF-8"}}]},{"uid":"b64b7e84-5c09-46ab-a12a-8801485ce045","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"cd0a1f98-3d14-4ebd-b575-19036a607631","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"f6714eac-303e-4994-b3fe-9d4daa621e1c","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ebaf3da8-28fc-4000-b6fa-ce713d2f18f8","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$rCSVRow[6]$$rCSVRow[7]$$rCSVRow[8]$"}}],"returnTo":{"type":"VARIABLE","variableName":"sOutputValue"}},{"uid":"bec782f2-fc6f-4751-af6a-41a97a647827","commandName":"addItem","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"lOutputValue"}},{"name":"listItem","value":{"type":"VARIABLE","variableName":"sOutputValue"}},{"name":"itemPosition","value":{"type":"STRING","string":"END"}}]}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$rCSVRow[2]$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","expression":"$sInputValue$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"boolean":false,"type":"BOOLEAN"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"rCSVRow"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.csvtxt","packageName":"CsvTxt"}}]}],"branches":[{"uid":"051c6e9c-87d3-4604-b446-ac9069d0da8e","commandName":"elseIf","packageName":"If","disabled":false,"children":[{"uid":"546f6a1a-ab6b-4622-9747-26cc43a5cf35","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"f1b6f941-742c-42fd-8b35-ffcc56e7cfd0","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"68df60b2-5471-42a1-82d0-a62bd93ae99a","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","expression":"$rCSVRow[2]$"}}],"returnTo":{"type":"VARIABLE","variableName":"sOutputValue"}},{"uid":"14520912-035a-474a-bf8b-8a04573a4b48","commandName":"addItem","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"lOutputValue"}},{"name":"listItem","value":{"type":"VARIABLE","variableName":"sOutputValue"}},{"name":"itemPosition","value":{"type":"STRING","string":"END"}}]}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$rCSVRow[6]$$rCSVRow[7]$$rCSVRow[8]$"}},{"name":"operator","value":{"type":"STRING","string":"INCLUDE"}},{"name":"value","value":{"type":"STRING","expression":"$sInputValue$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"boolean":false,"type":"BOOLEAN"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"rCSVRow"},"attributes":[{"name":"session","value":{"type":"STRING","string":"Default"}}],"value":{"type":"ITERATOR","iteratorName":"iterators.csvtxt","packageName":"CsvTxt"}}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sSearchType$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"address"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"boolean":false,"type":"BOOLEAN"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"88b97eb0-326e-4d3f-9525-1e6ada53910d","commandName":"else","packageName":"If","disabled":false,"children":[{"uid":"d2ddd22d-c0b5-438a-849b-a342fb8a0532","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","string":"Enter postcode or address as text for search type"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}]}],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sSearchType$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","string":"postcode"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":false}},{"name":"isIgnoreCarriage","value":{"boolean":false,"type":"BOOLEAN"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"CSVデータの検索"}}]},{"uid":"dbf117e2-d473-4e34-ae98-0c501efcab36","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"dfcbb303-f5a8-4e5c-a28a-926faddf4dd3","commandName":"assign","packageName":"String","disabled":false,"attributes":[{"name":"sourceString","value":{"type":"STRING","string":"一致なし"}}],"returnTo":{"type":"VARIABLE","variableName":"sOutputValue"}}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"STRING","expression":"$sOutputValue$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"STRING","expression":"$sNull$"}},{"name":"matchCase","value":{"type":"BOOLEAN","boolean":true}},{"name":"isIgnoreCarriage","value":{"boolean":false,"type":"BOOLEAN"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"stringVariable","packageName":"String"}}]},{"uid":"74ae10c0-5d00-44c4-855b-3027c0120ebd","commandName":"step","packageName":"Step","disabled":true,"children":[{"uid":"eb1a493c-a1ad-4e28-9462-7cc6a9333cfc","commandName":"listSize","packageName":"List","disabled":false,"attributes":[{"name":"sourceList","value":{"type":"VARIABLE","variableName":"lOutputValue"}}],"returnTo":{"type":"VARIABLE","variableName":"nResultCount"}},{"uid":"d3fce0ce-87d4-4abf-a38c-a03544e3f91b","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"de50e2db-713f-4508-a029-c75da1ea8abc","commandName":"messageBox","packageName":"MessageBox","disabled":true,"attributes":[{"name":"title","value":{"type":"STRING","string":"Result"}},{"name":"content","value":{"type":"STRING","string":"There was no result"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"41191ded-ecbe-4ea3-a17d-0b192c30e5bb","commandName":"throw","packageName":"ErrorHandler","disabled":false,"attributes":[{"name":"message","value":{"type":"STRING","string":"There were no results"}},{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}]}],"branches":[],"attributes":[{"attributes":[{"name":"variable","value":{"type":"NUMBER","expression":"$nResultCount$"}},{"name":"operator","value":{"type":"STRING","string":"EQ"}},{"name":"value","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"numberVariable","packageName":"Number"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"項目がない場合はエラーを生成"}}]},{"uid":"d010f959-e913-4629-8006-e01cf476e753","commandName":"step","packageName":"Step","disabled":true,"children":[{"uid":"f3cd9605-2293-41dd-8dfc-68ba444ea7a7","commandName":"loop.commands.start","packageName":"Loop","disabled":false,"children":[{"uid":"2a09ce22-06e6-408f-876a-66b21cfb0899","commandName":"messageBox","packageName":"MessageBox","disabled":false,"attributes":[{"name":"title","value":{"type":"STRING","string":"Result"}},{"name":"content","value":{"type":"STRING","expression":"$prompt-assignment$"}},{"name":"scrollLines","value":{"type":"NUMBER","number":"30"}},{"name":"closeMsgBox","value":{"type":"BOOLEAN","boolean":false}}]}],"attributes":[{"name":"loopType","value":{"type":"STRING","string":"ITERATOR"}},{"name":"iterator","returnTo":{"type":"VARIABLE","variableName":"prompt-assignment"},"attributes":[{"name":"list","value":{"type":"VARIABLE","variableName":"lOutputValue"}},{"name":"forOptions","value":{"type":"STRING","string":"all"}}],"value":{"type":"ITERATOR","iteratorName":"list.iterators.list","packageName":"List"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"値の確認"}}]}],"branches":[{"uid":"60be7a36-4aa8-4850-869c-7124d855a4e7","commandName":"catch","packageName":"ErrorHandler","disabled":false,"children":[{"uid":"870b159c-92b5-4b73-84bd-c9797086fe72","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"エラー時に実行されるロジックを下記に記入します"}}]},{"uid":"359d1a00-2680-453f-9079-60366eab4b05","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"11a68baf-d4fc-4d29-be81-fb8124bb15a5","commandName":"if","packageName":"If","disabled":false,"children":[{"uid":"ac14632f-e991-490f-ae24-7f197a732c05","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"ヘッダー行を作成できるように、ファイルが以前に存在しない場合は作成する"}}]},{"uid":"b4b4cacf-06da-45ba-90fb-ec61a92eb192","commandName":"createFile","packageName":"File","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sLogFolder$/$sCurrentDate$_$sBotName$.csv"}},{"name":"isOverwrite","value":{"type":"BOOLEAN","boolean":false}}]},{"uid":"f0fc8a70-1eca-48f7-b767-c636f9cdeaea","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sLogFolder$/$sCurrentDate$_$sBotName$.csv"}},{"name":"logContent","value":{"type":"STRING","string":"日付,システム,タスク名,エラーライン,エラー説明"}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"branches":[],"attributes":[{"attributes":[{"name":"sourceFilePath","value":{"type":"FILE","expression":"file://$sLogFolder$/$sCurrentDate$_$sBotName$.csv"}},{"name":"waitTimeout","value":{"type":"NUMBER","number":"0"}}],"name":"condition","value":{"type":"CONDITIONAL","conditionalName":"fileNotExists","packageName":"File"}}]},{"uid":"4b805343-189c-475a-93a4-526af84ff8e5","commandName":"toString","packageName":"Datetime","disabled":false,"attributes":[{"name":"source","value":{"type":"VARIABLE","packageName":"System","variableName":"Date"}},{"name":"selectPattern","value":{"type":"STRING","string":"PREBUILT"}},{"name":"preBuiltPattern","value":{"type":"STRING","string":"ISO_LOCAL_DATE_TIME"}}],"returnTo":{"type":"VARIABLE","variableName":"sDateTime"}},{"uid":"601ef24d-c854-4e9a-bd8c-a63fbe0156d1","commandName":"toString","packageName":"Number","disabled":false,"attributes":[{"name":"input","value":{"type":"NUMBER","expression":"$nErrorLineNumber$"}},{"name":"numFormatDigits","value":{"type":"NUMBER","number":"0"}}],"returnTo":{"type":"VARIABLE","variableName":"sErrorLineNumber"}},{"uid":"07d66009-84d9-44fe-8ce5-75d22dcb57cf","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"ヘッダー行が確立された形式に一致するファイルへのログ記録エラー"}}]},{"uid":"6dd9e224-7f28-4f81-b2ce-a08be9b18d26","commandName":"logToFile","packageName":"LogToFile","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sLogFolder$/$sCurrentDate$_$sBotName$.csv"}},{"name":"logContent","value":{"type":"STRING","expression":"$sDateTime$,$System:Machine$,$System:AATaskName$,$sErrorLineNumber$,\"$sErrorDescription$\""}},{"name":"appendTimestamp","value":{"type":"BOOLEAN","boolean":false}},{"name":"logOption","value":{"type":"STRING","string":"APPEND_FILE"}},{"name":"encodingValue","value":{"type":"STRING","string":"UTF8"}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Log Error"}}]},{"uid":"45b7a25c-38c1-4a07-beec-d360bfca4dc9","commandName":"step","packageName":"Step","disabled":false,"children":[{"uid":"ae16dc65-c123-48e1-9d12-ab68386efb8e","commandName":"Comment","packageName":"Comment","disabled":false,"attributes":[{"name":"comment","value":{"type":"STRING","string":"スナップショットを撮ります。 画面にプレーンテキストのパスワードなどが含まれる可能性がある場合は、このアクションを無効にするか削除してください"}}]},{"uid":"535851c4-9801-432a-8feb-79480f2eb598","commandName":"captureDesktop","packageName":"Screen","disabled":false,"attributes":[{"name":"filePath","value":{"type":"FILE","expression":"file://$sSnapshotsFolder$/$sCurrentDate$_$sBotName$.jpg"}},{"name":"isOverwriteFile","value":{"type":"BOOLEAN","boolean":true}}]}],"attributes":[{"name":"title","value":{"type":"STRING","string":"Record Snapshot"}}]}],"attributes":[{"name":"exceptionType","value":{"type":"EXCEPTION","exceptionName":"BotException","packageName":"ErrorHandler"}}],"returns":{"errorMessage":{"type":"VARIABLE","variableName":"sErrorDescription"},"errorLineNumber":{"type":"VARIABLE","variableName":"nErrorLineNumber"}}}]}],"variables":[{"name":"prompt-assignment","description":"A variable you can use for assignments","type":"STRING","subtype":"UNDEFINED","readOnly":false,"input":false,"output":false},{"name":"sRootLogDirectory","description":"Root directory for creating bot logs - can be customized or left as default","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"C:\\ProgramData\\AutomationAnywhere\\Bots\\Logs"}},{"name":"sErrorFolder","description":"Bot Specific Error Folder within Logging Root Directory","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sBotName","description":"REQUIRED: Bot Name (as listed in Bot Store) of the submitted Bot - doesn't have to match the file name of bot itself","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sVendorName","description":"REQUIRED: Vendor Name as listed in Bot Store submission","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sLogFolder","description":"Log Folder Location for Bot Specific Logs","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sSnapshotsFolder","description":"Snapshot folder for Bot Specific Snapshots","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sErrorDescription","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"nErrorLineNumber","description":"Error Line Number as returned by the Catch Error Handler","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"sErrorLineNumber","description":"String representation of the Error Line Number returned by the Catch Error Handler","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sCurrentDate","description":"Current Date used for Logging Purposes","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sDateTime","description":"Current Date/Time for use inside of Logging files","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"nErrorTest","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"dFileList","description":"","type":"DICTIONARY","readOnly":false,"input":false,"output":false,"subtype":"STRING","defaultValue":{"type":"DICTIONARY","dictionary":[]}},{"name":"nLoggingPeriod","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"NUMBER","number":"30"}},{"name":"dtLogCutoffDate","description":"","type":"DATETIME","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"DATETIME","string":""}},{"name":"sLogCutoffDate","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"STRING","string":""}},{"name":"sNull","description":"Empty value to check for the presence of empty strings","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sInputValue","description":"Postcode or address","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"sOutputValue","description":"","type":"STRING","readOnly":false,"input":false,"output":true,"defaultValue":{"type":"STRING","string":""}},{"name":"sWorkingDirectory","description":"Working directory for postcode data - can be customized or left as default","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"C:\\ProgramData\\AutomationAnywhere\\Bots\\work\\PostCodeJP"}},{"name":"sCSVFileName","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":"x-ken-all.csv.utf8.csv"}},{"name":"sPostCode","description":"","type":"STRING","readOnly":false,"input":false,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"rCSVRow","description":"","type":"RECORD","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"RECORD","record":{"schema":[],"values":[]}}},{"name":"lOutputValue","description":"","type":"LIST","readOnly":false,"input":false,"output":true,"subtype":"STRING","defaultValue":{"type":"LIST","list":[]}},{"name":"sSearchType","description":"Enter postcode or address as text","type":"STRING","readOnly":false,"input":true,"output":false,"defaultValue":{"type":"STRING","string":""}},{"name":"nResultCount","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}},{"name":"nInputValueLength","description":"","type":"NUMBER","readOnly":false,"input":false,"output":false,"subtype":"UNDEFINED","defaultValue":{"type":"NUMBER","number":"0"}}],"breakpoints":[],"packages":[{"name":"CsvTxt","version":"2.3.0-20201126-165126"},{"name":"Comment","version":"2.3.0-20201126-165125"},{"name":"Datetime","version":"2.2.0-20201126-165136"},{"name":"ErrorHandler","version":"2.3.0-20201126-165148"},{"name":"File","version":"3.2.0-20201126-165151"},{"name":"Folder","version":"3.1.0-20201126-165154"},{"name":"If","version":"2.1.0-20201126-165201"},{"name":"List","version":"2.2.0-20201126-165427"},{"name":"LogToFile","version":"2.2.0-20201126-165428"},{"name":"Loop","version":"2.1.0-20201126-165429"},{"name":"MessageBox","version":"2.1.0-20201126-165430"},{"name":"Number","version":"2.1.0-20201126-165444"},{"name":"Screen","version":"2.2.0-20201126-165855"},{"name":"Step","version":"2.0.0-20201023-202658"},{"name":"String","version":"3.1.0-20201126-165909"},{"name":"System","version":"3.0.0-20200921-090225"},{"name":"TaskBot","version":"2.0.1-20201023-202703"}],"workItemTemplateName":null}